title = "Welcome :: June 20, 2015"
url = "/"
layout = "default"
hidden = "0"
==
<?php
function onSubmit()
{
    $data = Input::all();
    $rules = ['name' => 'required', 'password' => 'required', 'attending' => 'required|digits_between:1,4'];
    $msgs = ['required' => 'You must enter something here.','digits_between' => 'Right now we\'re expecting 1-4 attendees!'];
    $v = Validator::make($data, $rules, $msgs);

    if ($v->fails())
    {
        $this['result'] = ['error' => $v->messages()->first()];
        Flash::error($v->messages()->first());
        return;
    } else {
        if (md5(post('password')) === '098f6bcd4621d373cade4e832627b4f6') {
            Mail::queue('emails.rsvp', $data, function($message)
            {
                $message->from('wedding@gretaandjeremy.com', post('name'));
    
                $message->to('j@gretaandjeremy.com')->subject('RSVP Received: '.post('name'));
    
            });
    
            $this['result'] = ['success' => 'RSVP Received! See you there!'];
            Flash::success('RSVP Received! See you there!');
            return;
        } else {
            $this['result'] = ['error' => 'Password didn\'t match.'];
            Flash::error('Password didn\'t match.');
            return;
        }
    }
    
    $this['result'] = ['error' => 'Something didn\'t work!'];
    Flash::error('Something didn\'t work!');
}
?>
==
<div class="container-fluid">
    {% partial 'welcome.htm' %}
    <!-- Header -->
    <header id="layout-header" class="header-navbar">
        <!-- Nav -->
        {% partial "nav" %}
    </header>
    {% partial 'story.htm' %}
    {% partial 'gallery.htm' %}
    {% partial 'people.htm' %}
    {% partial 'events.htm' %}
    {% partial 'travel.htm' %}
    {% partial 'registry.htm' %}
    {% partial 'rsvp.htm' %}
</div>